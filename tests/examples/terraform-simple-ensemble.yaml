apiVersion: unfurl/v1alpha1
kind: Ensemble
spec:
  service_template:
    topology_template:
      node_templates:
        example:
          type: unfurl.nodes.Installer.Terraform
          interfaces:
            defaults:
              inputs:
                tfvars:
                  tag: test
                main: |
                  terraform {
                    # This module is now only being tested with Terraform 0.13.x. However, to make upgrading easier, we are setting
                    # 0.12.26 as the minimum version, as that version added support for required_providers with source URLs, making it
                    # forwards compatible with 0.13.x code.
                    required_version = ">= 0.12.26"
                  }

                  variable "tag" {
                    type        = string
                  }

                  output "tag" {
                    value = "Hello, ${var.tag}!"
                  }

            Standard:
              operations:
                create:
                  inputs:
                    resultTemplate: |
                      # merge all outputs into attributes
                      attributes:
                        <<: {{ outputs | mapValue | to_json }}
